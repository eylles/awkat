#!/bin/sh
awkcmd() {
awk -v file="$*" '
    BEGIN { print  "\x1b[30;1m───────┬────────────────────────────────────────────────────────────────────────\x1b[0m" };
    BEGIN { printf "\x1b[30;1m%6s │\x1b[0m \x1b[32;1m %s \x1b[0m \n", "file", file };
    BEGIN { print  "\x1b[30;1m───────┼────────────────────────────────────────────────────────────────────────\x1b[0m" };
          { printf "\x1b[30;1m%6d │\x1b[0m %s\n", NR, $0 };
    END   { print  "\x1b[30;1m───────┴────────────────────────────────────────────────────────────────────────\x1b[0m" };
    '
}

if [ "$#" -gt 1 ]; then
    /bin/cat "$@" | awkcmd "$@"
else
    highlight -O ansi --force "$1" | awkcmd "$@"
fi
